var token = '6092254540:AAFhEoR0ihNlMrj-vpZUOIWzuaDlzniqjyg'; // Reemplazar con el token de tu bot
var telegramUrl = 'https://api.telegram.org/bot' + token;
var spreadsheetId = '19w74Zp5kiSPvDEqalr5kDc7mdNrU1O-TwwhFqzxXUCg'; // Reemplazar con la ID de la hoja de c√°lculo donde se agregar√°n los mensajes
var webAppUrl = "https://script.google.com/macros/s/AKfycbx_Ez1oqClkOwOa-FkyJW80w-hLvi1CwxCjLe_MYqz8bS91zrW5mDQ7ydMPdsRBXDUe/exec"; // Reemplazar con la URL p√∫blica de tu aplicaci√≥n web

function setWebhook() {
  var url = telegramUrl + '/setWebhook?url=' + webAppUrl;
  UrlFetchApp.fetch(url);
}

function deleteWebhook() {
  var url = telegramUrl + '/deleteWebhook';
  UrlFetchApp.fetch(url);
}

function doGet(e) {
  return HtmlService.createHtmlOutput('Hola');
}

function sendText(id, answer) {
  var url = telegramUrl + '/sendMessage?chat_id=' + id + '&text=' + answer;
  UrlFetchApp.fetch(url);
}

function sendTextWithButtons(id, answer, keyboard) {
  var data = {
    method: 'post',
    payload: {
      method: 'sendMessage',
      chat_id: String(id),
      text: answer,
      reply_markup: keyboard
    }
  }
  UrlFetchApp.fetch(telegramUrl + '/', data);
}

function doPost(e) {
  var contents = JSON.parse(e.postData.contents);
  
  if (contents.message){

  var text = contents.message.text;
  var id = contents.message.chat.id;
  var name = contents.message.chat.first_name;
  var resp = contents.message.reply_to_message;
  var word = text.split(" ")

  var spreadsheet = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Mensajes');
  spreadsheet.appendRow([new Date(), id, name, text]);

//COMPLETA*************************************
if (resp == '?'){

  sendText(id,'hola mm')
}

switch (word[0]) {

      case  '.':
      sendMessage(id,'Cuanto deseas enviar?');
      
      break;

      case '/enlaces':

        var keyboard = {
          'inline_keyboard': [
            [{
              'text': 'Sitio Web',
              'url': 'https://cambios.ml/'
            },{
              'text': 'Intagram',
              'url': '@remesas.ml'
            }]
          ]
        };
        sendTextWithButtons(id, 'Conocenos mejor', JSON.stringify(keyboard));
        break;
      case '/start':
        var keyboard = {
          'inline_keyboard': [
            [{
              'text': 'üí± Tasas ',
              'callback_data': 'tasas'
            }],
            [{
              'text': 'ÔøΩ',
              'callback_data': 'enviar'
            }]
          ]
        };
        sendTextWithButtons(id, 'Algunas consultas', JSON.stringify(keyboard));
        
    
    var idq = contents.callback_query.message.chat.id;
    var dataq = contents.callback_query.data;
    var answerq = 'Has pulsado la acci√≥n n√∫mero ' + dataq;
    sendText(idq, answerq);
  
  break;
}
if( id == '1673977960') {

  switch (word[0]){

    case 'Total':

var moneda = '$'
 var ts = SpreadsheetApp.openById(spreadsheetId).getSheetByName('datatest');
    var total = ts.getRange('E1').getValue();
    var ganar = ts.getRange('E2').getValue();
    var pagar = ts.getRange('E3').getValue();
    
    sendText(id, "Tienes " + total + " " + moneda + " enviados. Tu ganacia es de " + ganar + " " + moneda + ". Posees " + pagar + " " + moneda + " en tus fondos.")
    console.log(id, "Tienes " + totalecuVzla + "$ en tus fondos.");
    break;}

switch (word[1]) {

  case '$' :

    GmailApp.sendEmail('javier_rizza@hotmail.com', word[0] + word[1] + " a esta tasa " + tasa , name + " " + text);

    var moneda = '$'

    var cs = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
    var tasa = cs.getRange('C16').getValue();

    var xs = SpreadsheetApp.openById(spreadsheetId).getSheetByName('@yosi');
   xs.appendRow([new Date(), id, name, word[0], tasa, text]);
  
    sendText(id, "Anotados " + word[0] + " " + moneda + " , Estos seran anotados a tu balance.");
    console.log(id, "Anotados " + word[0] + " " + moneda + ", Estos seran anotados a tu balance.");
break;

  case 'Zelle':

    GmailApp.sendEmail('javier_rizza@hotmail.com', word[0] + word[1] + " a esta tasa " + tasa , name + " " + text);

    var moneda = '$'

    var cs = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
    var tasa = cs.getRange('C16').getValue();

    var xs = SpreadsheetApp.openById(spreadsheetId).getSheetByName('@yosi');
   xs.appendRow([new Date(), id, name, "0", tasa, text, word[0]]);
  
    sendText(id, "Anotados " + word[0] + " " + moneda + " , la comision es a√±adida a tu ganancia total.");
    console.log(id, "Anotados " + word[0] + " " + moneda + ", Estos seran anotados a tu balance."); 
    break;

    case 'Chile':

    GmailApp.sendEmail('javier_rizza@hotmail.com', word[0] + word[1] + " a esta tasa " + tasa , name + " " + text);

    var moneda = '$'

    var xs = SpreadsheetApp.openById(spreadsheetId).getSheetByName('@yosi');
   xs.appendRow([new Date(), id, name, "0", tasa, text, "0", word[0]]);
  
    sendText(id, "Anotados " + word[0] + " " + moneda + " , la comision es a√±adida a tu ganancia total.");
    console.log(id, "Anotados " + word[0] + " " + moneda + ", Estos seran anotados a tu balance.");
    break;

  case 'Peru':

    GmailApp.sendEmail('javier_rizza@hotmail.com', word[0] + word[1] + " a esta tasa " + tasa , name + " " + text);

    var moneda = '$'

    var xs = SpreadsheetApp.openById(spreadsheetId).getSheetByName('@yosi');
   xs.appendRow([new Date(), id, name, "0", tasa, text,"0", "0", word[0]]);
  
    sendText(id, "Anotados " + word[0] + " " + moneda + " , la comision es a√±adida a tu ganancia total.");
    console.log(id, "Anotados " + word[0] + " " + moneda + ", Estos seran anotados a tu balance.");
    break;

}

}
if( id == '-861331568') {

switch (word[1]) {

  case '@yosi':

    GmailApp.sendEmail('Yosiany_Meza24@outlook.es', "Fueron tomados" + word[0] + moneda + " de tus fondos " ,text );

    var moneda = '$'

    var xs = SpreadsheetApp.openById(spreadsheetId).getSheetByName('@yosi');
   xs.appendRow([new Date(), id, name, "0", tasa, text,"0", "0", "0", word[0]]);
  
    sendText(id, "Descontados " + word[0] + " " + moneda + " , de los fondos de Ecuados.");
    console.log(id, "Anotados " + word[0] + " " + moneda + ", Estos seran anotados a tu balance.");
   
    var ts = SpreadsheetApp.openById(spreadsheetId).getSheetByName('datatest');
    var total = ts.getRange('E1').getValue();
    var ganar = ts.getRange('E2').getValue();
    var pagar = ts.getRange('E3').getValue();
    
    sendText(id, "Tienes " + total + " " + moneda + " enviados. Tu ganacia es de " + ganar + " " + moneda + ". Posees " + pagar + " " + moneda + " en tus fondos.")
    console.log(id, "Tienes " + totalecuVzla + "$ en tus fondos.");


  case 'lucas' :

    var moneda = 'Pesos'

    GmailApp.sendEmail('javier_rizza@hotmail.com', word[0] + word[1] , name + " " + text);

    var chlvzlasheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
    var tax = chlvzlasheets.getRange('C14').getValue();

  //****FORMULA PARA CALCULAR PRECIO DOLAR CHLVZL******
    var myFormul = "=D2*E2"
    var arrassheet = SpreadsheetApp.openById(spreadsheetId).getSheetByName('test');
    arrassheet.getRange(2,8,arrassheet.getLastRow()).setFormula(myFormul)


    var expsheet = SpreadsheetApp.openById(spreadsheetId).getSheetByName('test');
   expsheet.appendRow([new Date(), id, name, word[0], "1000", tax, text]);
  
   var row = expsheet.getDataRange().getNumRows();
    var valo = expsheet.getDataRange().getCell(row,8).getValue();
    var desc = expsheet.getDataRange().getCell(row,2).getValue();
    sendText(id, "Anotados " + valo + " Pesos Chilenos, Estos seran anotados a tu balance.");
    console.log(id, "Anotados " + desc + " Pesos Chilenos")

    var testsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('datatest');
    var total = testsheets.getRange('A1').getValue();
    var ganar = testsheets.getRange('A2').getValue();
    var pagar = testsheets.getRange('A3').getValue();
    
    sendText(id, "Tienes " + total + " " + moneda + " enviados. Tu ganacia es de " + ganar + " " + moneda + ". Posees " + pagar + " " + moneda + " en tus fondos.")
    console.log(id, "Tienes " + totalecuVzla + "$ en tus fondos.");
    break;

  case '$' : 

    var $chlVzlsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
    var taxD = $chlVzlsheets.getRange('B24').getValue();

    var testsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('datatest');
    var totalD = testsheets.getRange('A1').getValue();

    var expsheetd = SpreadsheetApp.openById(spreadsheetId).getSheetByName('test');
    expsheetd.appendRow([new Date(), id, name, word[0], taxD, "1", text]);
    sendText(id, "Anotados " + word[0] + " $ A tu balance");
    console.log(id, "Anotados " + word[0] + " A tu balance");

//****FORMULA PARA CALCULAR PRECIO DOLAR CHLVZL******
    var myFormula = "=D2*E2"
    var arrassheet = SpreadsheetApp.openById(spreadsheetId).getSheetByName('test');
    arrassheet.getRange(2,8,arrassheet.getLastRow()-1).setFormula(myFormula)

//LEER
    var rows = expsheetd.getDataRange().getNumRows();
    var valor = expsheetd.getDataRange().getCell(rows,8).getValue();
    var desc = expsheetd.getDataRange().getCell(rows,2).getValue();
    sendText(id, "Nuestro cliente debe depositar " + valor + " Pesos Chilenos, Estos seran anotados a tu balance.");
    console.log(id, "Nuestro cliente debe depositar " + valor + " Pesos Chilenos")
    break;

}
//*********TASAS DESDE VENEZUELA**********
} switch (text) {
      case 'Vzla-Chile':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('D13').getValue();
        sendText(id, answer);
        break;

      case 'Vzla-Peru':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('E13').getValue();
        sendText(id, answer);
        break;
      
      case 'Vzla-Ecuador':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('F13').getValue();
        sendText(id, answer);
        break;

      case 'Vzla-Colombia':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('G13').getValue();
        sendText(id, answer);
        break;

//*********TASAS DESDE CHILE**********

      case 'Chile-Vzla':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('C14').getValue();
        sendText(id, answer);
        break;

      case 'Chile-Peru':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('E14').getValue();
        sendText(id, answer);
        break;
      
      case 'Chile-Ecuador':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('F14').getValue();
        sendText(id, answer);
        break;

      case 'Chile-Colombia':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('G14').getValue();
        sendText(id, answer);
        break;
  
//*********TASAS DESDE PERU**********

      case 'Peru-Vzla':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('C15').getValue();
        sendText(id, answer);
        break;

      case 'Peru-Chile':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('D15').getValue();
        sendText(id, answer);
        break;
      
      case 'Peru-Ecuador':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('F15').getValue();
        sendText(id, answer);
        break;

      case 'Peru-Colombia':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('G15').getValue();
        sendText(id, answer);
        break;

//*********TASAS DESDE ECUADOR**********

      case 'Ecuador-Vzla':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('C16').getValue();
        sendText(id, answer);
        break;

      case 'Ecuador-Chile':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('D16').getValue();
        sendText(id, answer);
        break;
      
      case 'Ecuador-Peru':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('E16').getValue();
        sendText(id, answer);
        break;

      case 'Ecuador-Colombia':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('G16').getValue();
        sendText(id, answer);
        break;  

//*********TASAS DESDE PAYPAL**********

      case 'Paypal-Vzla':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('C18').getValue();
        sendText(id, answer);
        break;

      case 'Paypal-Chile':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('D18').getValue();
        sendText(id, answer);
        break;
      
      case 'Paypal-Peru':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('E18').getValue();
        sendText(id, answer);
        break;

      case 'Paypal-Ecuador':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('F18').getValue();
        sendText(id, answer);
        break;

      case 'Paypal-Colombia':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('G18').getValue();
        sendText(id, answer);
        break;  

//*********TASAS DESDE ZELLE**********

      case 'Zelle-Vzla':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('C19').getValue();
        sendText(id, answer);
        break;

      case 'Zelle-Chile':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('D19').getValue();
        sendText(id, answer);
        break;
      
      case 'Zelle-Peru':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('E19').getValue();
        sendText(id, answer);
        break;

      case 'Zelle-Ecuador':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('F19').getValue();
        sendText(id, answer);
        break;

      case 'Zelle-Colombia':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('G19').getValue();
        sendText(id, answer);
        break; 

//*********TASAS DESDE EUROPA**********

      case 'Euro-Vzla':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('C20').getValue();
        sendText(id, answer);
        break;

      case 'Ecuador-Chile':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('D16').getValue();
        sendText(id, answer);
        break;
      
      case 'Ecuador-Peru':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('E16').getValue();
        sendText(id, answer);
        break;

      case 'Ecuador-Colombia':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('G14').getValue();
        sendText(id, answer);
        break;

//*********PRECIO POR DOLAR**********

      case 'Chile$Vzla':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('B24').getValue();
        sendText(id, answer);
        break;   

       case 'Chile$Paralelo':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('B26').getValue();
        sendText(id, answer);
        break;     

      
      //default: 
      //var answer = 'Tome en cuenta abreviaciones, mayusculas y minusculas. Utilize el comando /start para abrir el menu.';
      // sendText(id, answer);
      // break;
 
      } 


  }else if (contents.callback_query) {
    var id = contents.callback_query.message.chat.id;
    var data = contents.callback_query.data;
   

    switch (data) {

      case 'enviar':
      sendMessage(id,'?');
    break;

      case 'tasas':

    var keyboard = {
          'inline_keyboard': [
            [{
              'text': 'üá®üá± Chile',
              'callback_data': 'Clp'
              
            }],[
            {
              'text': 'üáªüá™ Vzla',
              'callback_data': 'Ves'
            }],[
            {
              'text': 'üáµüá™ Per√∫',
              'callback_data': 'Pen'
              
            }],[
            {
              'text': 'üá™üá® Ecuador',
              'callback_data': 'Usd'
            }],[
            {
              'text': 'üá®üá¥ Colombia',
              'callback_data': 'Cop'
              
            }],[
            {
              'text': 'üá∫üá∏ Zelle',
              'callback_data': 'Zel'
            }],[
            {
              'text': 'üí≤ Paypal',
              'callback_data': 'Pay'
              
            }],[
            {
              'text': '‚Ç¨ Europa',
              'callback_data': 'Eur'
            }]
          ]
        };
    sendTextWithButtons(id, 'Enviar dinero desde:', JSON.stringify(keyboard));
    break;
    
    case 'Clp':

    var keyboard = {
          'inline_keyboard': [
            [
            {
              'text': 'üìå Chile‚û≠Vzla',
              'callback_data': 'ClpVes'
            },
            {
              'text': 'üìå Chile‚û≠Per√∫',
              'callback_data': 'ClpPen'
              
            }],[
            {
              'text': 'üìå Chile‚û≠Ecuador',
              'callback_data': 'ClpUsd'
            },
            {
              'text': 'üìå Chile‚û≠Colombia',
              'callback_data': 'ClpCop'
              
            }],[
            {
              'text': 'üìå Chile‚û≠Zelle',
              'callback_data': 'ClpZel'
            },
            {
              'text': 'üìå Chile‚û≠Paypal',
              'callback_data': 'ClpPay'
              
            }],[
            {
              'text': 'üìå Chile‚û≠Europa',
              'callback_data': 'ClpEur'
            }]
          ]
        };
    sendTextWithButtons(id, 'Tipo de cambio:', JSON.stringify(keyboard));
    break;

    case 'Ves':

    var keyboard = {
          'inline_keyboard': [
            [{
              'text': 'üìå Vzla‚û≠Chile',
              'callback_data': 'VesClp'
              
            },
            {
              'text': 'üìå Vzla‚û≠Per√∫',
              'callback_data': 'VesPen'
              
            }],[
            {
              'text': 'üìå Vzla‚û≠Ecuador',
              'callback_data': 'VesUsd'
            },
            {
              'text': 'üìå Vzla‚û≠Colombia',
              'callback_data': 'VesCop'
              
            }],[
            {
              'text': 'üìå Vzla‚û≠Zelle',
              'callback_data': 'VesZel'
            },
            {
              'text': 'üìå Vzla‚û≠Paypal',
              'callback_data': 'VesPay'
              
            }],[
            {
              'text': 'üìå Vzla‚û≠Europa',
              'callback_data': 'VesEur'
            }]
          ]
        };
    sendTextWithButtons(id, 'Tipo de cambio:', JSON.stringify(keyboard));
    break;
    
    case 'Pen':

    var keyboard = {
          'inline_keyboard': [
            [{
              'text': 'üìå Per√∫‚û≠Chile',
              'callback_data': 'PenClp'
              
            },
            {
              'text': 'üìå Per√∫‚û≠Vzla',
              'callback_data': 'PenVes'
            }],[
            {
              'text': 'üìå Per√∫‚û≠Ecuador',
              'callback_data': 'PenUsd'
            },
            {
              'text': 'üìå Per√∫‚û≠Colombia',
              'callback_data': 'PenCop'
              
            }],[
            {
              'text': 'üìå Per√∫‚û≠Zelle',
              'callback_data': 'PenZel'
            },
            {
              'text': 'üìå Per√∫‚û≠Paypal',
              'callback_data': 'PenPay'
              
            }],[
            {
              'text': 'üìå Per√∫‚û≠Europa',
              'callback_data': 'PenEur'
            }]
          ]
        };
    sendTextWithButtons(id, 'Tipo de cambio:', JSON.stringify(keyboard));
    break;
    
    case 'Usd':

    var keyboard = {
          'inline_keyboard': [
            [{
              'text': 'üìå Ecuador‚û≠Chile',
              'callback_data': 'Clp'
              
            },
            {
              'text': 'üìå Ecuador‚û≠Vzla',
              'callback_data': 'UsdVes'
            }],[
            {
              'text': 'üìå Ecuador‚û≠Per√∫',
              'callback_data': 'UsdPen'
              
            },
            {
              'text': 'üìå Ecuador‚û≠Colombia',
              'callback_data': 'UsdCop'
              
            }],[
            {
              'text': 'üìå Ecuador‚û≠Zelle',
              'callback_data': 'UsdZel'
            },
            {
              'text': 'üìå Ecuador‚û≠Paypal',
              'callback_data': 'UsdPay'
              
            }],[
            {
              'text': 'üìå Ecuador‚û≠Europa',
              'callback_data': 'UsdEur'
            }]
          ]
        };
    sendTextWithButtons(id, 'Tipo de cambio:', JSON.stringify(keyboard));
    break;
    
    case 'Cop':

    var keyboard = {
          'inline_keyboard': [
            [{
              'text': 'üìå Colombia‚û≠Chile',
              'callback_data': 'CopClp'
              
            },
            {
              'text': 'üìå Colombia‚û≠Vzla',
              'callback_data': 'CopVes'
            }],[
            {
              'text': 'üìå Colombia‚û≠Per√∫',
              'callback_data': 'CopPen'
              
            },
            {
              'text': 'üìå Colombia‚û≠Ecuador',
              'callback_data': 'CopUsd'
            }],[
            {
              'text': 'üìå Colombia‚û≠Zelle',
              'callback_data': 'CopZel'
            },
            {
              'text': 'üìå Colombia‚û≠Paypal',
              'callback_data': 'CopPay'
              
            }],[
            {
              'text': 'üìå Colombia‚û≠Europa',
              'callback_data': 'CopEur'
            }]
          ]
        };
    sendTextWithButtons(id, 'Tipo de cambio:', JSON.stringify(keyboard));
    break;
    
    case 'Zel':

    var keyboard = {
          'inline_keyboard': [
            [{
              'text': 'üìå Zelle‚û≠Chile',
              'callback_data': 'ZelClp'
              
            },
            {
              'text': 'üìå Zelle‚û≠Vzla',
              'callback_data': 'ZelVes'
            }],[
            {
              'text': 'üìå Zelle‚û≠Per√∫',
              'callback_data': 'ZelPen'
              
            },
            {
              'text': 'üìå Zelle‚û≠Ecuador',
              'callback_data': 'ZelUsd'
            }],[
            {
              'text': 'üìå Zelle‚û≠Colombia',
              'callback_data': 'ZelCop'
              
            },
            {
              'text': 'üìå Zelle‚û≠Paypal',
              'callback_data': 'ZelPay'
              
            }],[
            {
              'text': 'üìå Zelle‚û≠Europa',
              'callback_data': 'ZelEur'
            }]
          ]
        };
    sendTextWithButtons(id, 'Tipo de cambio: '+ answer, JSON.stringify(keyboard));
    break;
    
    case 'Pay':

    var keyboard = {
          'inline_keyboard': [
            [{
              'text': 'üìå Paypal‚û≠Chile',
              'callback_data': 'PayClp'
              
            },
            {
              'text': 'üìå Paypal‚û≠Vzla',
              'callback_data': 'PayVes'
            }],[
            {
              'text': 'üìå Paypal‚û≠Per√∫',
              'callback_data': 'PayPen'
              
            },
            {
              'text': 'üìå Paypal‚û≠Ecuador',
              'callback_data': 'PayUsd'
            }],[
            {
              'text': 'üìå Paypal‚û≠Colombia',
              'callback_data': 'PayCop'
              
            },
            {
              'text': 'üìå Paypal‚û≠Zelle',
              'callback_data': 'PayZel'
            }],[
            {
              'text': 'üìå Paypal‚û≠Europa',
              'callback_data': 'PayEur'
            }]
          ]
        };
    sendTextWithButtons(id, 'Enviar dinero desde:', JSON.stringify(keyboard));
    break;
    
//*********Respuestas CHILE*********

    case 'ClpVes':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('C14').getValue();
        sendText(id, 'Tasa Chile‚û≠Vzla ‚è©' + answer + '‚è™');
        break;

      case 'ClpPen':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('E14').getValue();
        sendText(id, 'Tasa Chile‚û≠Per√∫ ‚è©' + answer + '‚è™');
        break;
      
      case 'ClpUsd':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('F14').getValue();
        sendText(id, 'Tasa Chile‚û≠Ecuador ‚è©' + answer + '‚è™');
        break;

      case 'ClpCop':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('G14').getValue();
        sendText(id, 'Tasa Chile‚û≠Colombia ‚è©' + answer + '‚è™');
        break;

//**********Respuestas VENEZUELA**********

      case 'VesClp':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('D13').getValue();
        sendText(id, 'Tasa Venezuela‚û≠Chile ‚è©' + answer + '‚è™');
        break;

      case 'VesPen':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('E13').getValue();
        sendText(id, 'Tasa Venezuela‚û≠Per√∫ ‚è©' + answer + '‚è™');
        break;
      
      case 'VesUsd':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('F13').getValue();
        sendText(id, 'Tasa Venezuela‚û≠Ecuador ‚è©' + answer + '‚è™');
        break;

      case 'VesCop':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('G13').getValue();
        sendText(id, 'Tasa Venezuela‚û≠Colombia ‚è©' + answer + '‚è™');
        break;
  
//*********TASAS DESDE PERU**********

      case 'PenVes':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('C15').getValue();
        sendText(id, 'Tasa Peru‚û≠Venezuela ‚è©' + answer + '‚è™');
        break;

      case 'PenClp':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('D15').getValue();
        sendText(id, 'Tasa Peru‚û≠Chile ‚è©' + answer + '‚è™');
        break;
      
      case 'PenUsd':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('F15').getValue();
        sendText(id, 'Tasa Peru‚û≠Chile ‚è©' + answer + '‚è™');
        break;

      case 'PenCop':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('G15').getValue();
        sendText(id, 'Tasa Peru‚û≠Colombia ‚è©' + answer + '‚è™');
        break;

//*********TASAS DESDE ECUADOR**********

      case 'UsdVes':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('C16').getValue();
        sendText(id, 'Tasa Ecuador‚û≠Venezuela ‚è©' + answer + '‚è™');
        break;

      case 'UsdClp':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('D16').getValue();
        sendText(id, 'Tasa Ecuador‚û≠Chile ‚è©' + answer + '‚è™');
        break;
      
      case 'UsdPen':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('E16').getValue();
        sendText(id, 'Tasa Ecuador‚û≠Per√∫ ‚è©' + answer + '‚è™');
        break;

      case 'UsdCop':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('G16').getValue();
        sendText(id, 'Tasa Ecuador‚û≠Colombia ‚è©' + answer + '‚è™');
        break;  

//*********Respuestas PAYPAL**********

      case 'PayVes':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('C18').getValue();
        sendText(id, 'Tasa PayPal‚û≠Venezuela ‚è©' + answer + '‚è™');
        break;

      case 'PayClp':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('D18').getValue();
        sendText(id, 'Tasa PayPal‚û≠Chile ‚è©' + answer + '‚è™');
        break;
      
      case 'PayPen':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('E18').getValue();
        sendText(id, 'Tasa PayPal‚û≠Per√∫ ‚è©' + answer + '‚è™');
        break;

      case 'PayUsd':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('F18').getValue();
        sendText(id, 'Tasa PayPal‚û≠Ecuador ‚è©' + answer + '‚è™');
        break;

      case 'PayCop':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('G18').getValue();
        sendText(id, 'Tasa PayPal‚û≠Colombia ‚è©' + answer + '‚è™');
        break;  

//*********TASAS DESDE ZELLE**********

      case 'ZelVes':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('C19').getValue();
        sendText(id, 'Tasa Zelle‚û≠Venezuela ‚è©' + answer + '‚è™');
        break;

      case 'ZelClp':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('D19').getValue();
        sendText(id, 'Tasa Zelle‚û≠Chile ‚è©' + answer + '‚è™');
        break;
      
      case 'ZelPen':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('E19').getValue();
        sendText(id, 'Tasa Zelle‚û≠Per√∫ ‚è©' + answer + '‚è™');
        break;

      case 'ZelUsd':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('F19').getValue();
        sendText(id, 'Tasa Zelle‚û≠Ecuador ‚è©' + answer + '‚è™');
        break;

      case 'ZelCop':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('G19').getValue();
        sendText(id, 'Tasa Zelle‚û≠Colombia ‚è©' + answer + '‚è™');
        break; 

//*********TASAS DESDE EUROPA**********

      case 'Eur':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('C20').getValue();
        sendText(id, 'Tasa Europa‚û≠Venezuela ‚è©' + answer + '‚è™');
        break;

      case 'xxx':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('D16').getValue();
        sendText(id, answer);
        break;
      
      case 'xx':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('E16').getValue();
        sendText(id, answer);
        break;

      case 'x':
        var spreadsheets = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Tasas');
        var answer = spreadsheets.getRange('G14').getValue();
        sendText(id, answer);
        break;  

      default: 
        var answer = 'Comando no configurado, Para sugerencias escriba al WS:+584121542322 ';
        sendText(id, answer);
        break
    }

    

  }
}


